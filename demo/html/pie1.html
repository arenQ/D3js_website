<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript" src="../库文件/d3.js"></script>
    <style type="text/css">
        #block {
            width: 700px;
            height: 100px;
        }

        span {
            display: block;
            width: 200px;
            height: 22px;
            color: #ffffff;
            border: 1px;
            border-bottom-color: #000000;
            text-align: center;
        }
        div {
            font-family: verdana, arial, sans-serif;
            font-weight: bold;
            font-size: 18px;
        }
    </style>
</head>
<body>
<h1 style="text-align: center">饼图</h1>
<script type="text/javascript">
    var h=630;
    var w=620;

    var svg=d3.select("body")
            .append("svg")
            .attr("width",w)
            .attr("height",h)
            .style("background-color","black")
            .style("margin-left","300px");
    d3.text("../数据文件/pie.txt",function(error,Data){

        var dataset = Data.split(",");//读取txt文件里的数据

    //(1)转化数据为适合生成饼图的对象数组
    var pie=d3.layout.pie(dataset);//调用数据


    var outerRadius=w/2;//外半径

    //(7)圆环内半径
    var innerRadius=w/1024;//增大1024这个值可以让饼图变成圆环图

    //(2)用svg的path绘制弧形的内置方法
    var arc=d3.svg.arc()//设置弧度的内外径，等待传入的数据生成弧度
            .outerRadius(outerRadius)
            .innerRadius(innerRadius);

    //(3)颜色函数
    var color=d3.scale.category10();//创建序数比例尺和包括10中颜色的输出范围

    //(4)准备分组,把每个分组移到图表中心
    var arcs=svg.selectAll("g.arc")
            .data(pie(dataset))//调用数据
            .enter()
            .append("g")
            .attr("class","arc")
        //移到图表中心
            .attr("transform","translate("+outerRadius+","+outerRadius+")");//translate(a,b)a表示横坐标起点，b表示纵坐标起点

    //(5)为组中每个元素绘制弧形路路径
    arcs.append("path")//每个g元素都追加一个path元素用绑定到这个g的数据d生成路径信息
            .attr("fill",function(d,i){//填充颜色
                return color(i);
            })
            .attr("d",arc);//将角度转为弧度（d3使用弧度绘制）

    //(6)为组中每个元素添加文本
    arcs.append("text")//每个g元素都追加一个path元素用绑定到这个g的数据d生成路径信息
            .attr("transform",function(d){
                return "translate("+arc.centroid(d)+")";//计算每个弧形的中心点（几何中心）
            })
            .attr("text-anchor","middle")
            .style("fill","white")
            .style("font-size","28px")
            .text(function(d){
                return d.value+"%";//这里已经转为对象了
            });

    });

    window.onload = changeColor;
    function changeColor() {
        var color1=d3.scale.category10();
        var Span = document.getElementsByTagName("span");
        for (var i = 0; i < Span.length; i++) {
            Span[i].style.backgroundColor = color1(i);
        }
    }
</script>
<div>
    <h2>#js代码</h2>
    <pre style="border: 2px solid deepskyblue">
    <code>
        d3.text("../数据文件/pie.txt",function(error,Data){

        var dataset = Data.split(",");//读取txt文件里的数据

        //(1)转化数据为适合生成饼图的对象数组
        var pie=d3.layout.pie(dataset);//调用数据

        var h=630;
        var w=620;

        var outerRadius=w/2;//外半径

        //(7)圆环内半径
        var innerRadius=w/1024;//增大1024这个值可以让饼图变成圆环图

        //(2)用svg的path绘制弧形的内置方法
        var arc=d3.svg.arc()//设置弧度的内外径，等待传入的数据生成弧度
        .outerRadius(outerRadius)
        .innerRadius(innerRadius);

        var svg=d3.select("body")
        .append("svg")
        .attr("width",w)
        .attr("height",h)
        .style("background-color","black")
        .style("margin-left","300px");

        //(3)颜色函数
        var color=d3.scale.category10();//创建序数比例尺和包括10中颜色的输出范围

        //(4)准备分组,把每个分组移到图表中心
        var arcs=svg.selectAll("g.arc")
        .data(pie(dataset))//调用数据
        .enter()
        .append("g")
        .attr("class","arc")
        //移到图表中心
        .attr("transform","translate("+outerRadius+","+outerRadius+")");//translate(a,b)a表示横坐标起点，b表示纵坐标起点

        //(5)为组中每个元素绘制弧形路路径
        arcs.append("path")//每个g元素都追加一个path元素用绑定到这个g的数据d生成路径信息
        .attr("fill",function(d,i){//填充颜色
        return color(i);
        })
        .attr("d",arc);//将角度转为弧度（d3使用弧度绘制）

        //(6)为组中每个元素添加文本
        arcs.append("text")//每个g元素都追加一个path元素用绑定到这个g的数据d生成路径信息
        .attr("transform",function(d){
        return "translate("+arc.centroid(d)+")";//计算每个弧形的中心点（几何中心）
        })
        .attr("text-anchor","middle")
        .style("fill","white")
        .style("font-size","28px")
        .text(function(d){
        return d.value+"%";//这里已经转为对象了
        });

        });

        window.onload = changeColor;
        function changeColor() {
        var color1=d3.scale.category10();
        var Span = document.getElementsByTagName("span");
        for (var i = 0; i < Span.length; i++) {
        Span[i].style.backgroundColor = color1(i);
        }
        }
    </code>
</pre>
</div>
<div>
    <h2>#数据文件</h2>
    <pre style="border: 2px solid deepskyblue">
    <code>
        11.04,34.74,33.12,11.10,10.00
    </code>
</pre>
</div>
</body>
</html>